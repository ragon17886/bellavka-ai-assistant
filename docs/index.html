<!DOCTYPE html>
<html>
<head>
    <title>Bellavka Admin - Debug Direct</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        button { padding: 10px; margin: 5px; cursor: pointer; }
        pre { background: #f5f5f5; padding: 10px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üéØ Direct Endpoints Test</h1>

    <div>
        <button onclick="testDirect('users')">üë• Direct /users</button>
        <button onclick="testDirect('dialogs')">üí¨ Direct /dialogs</button>
        <button onclick="testDirectQuery()">üîß Direct /query</button>
        <button onclick="checkLogs()">üìã Check Console Logs</button>
    </div>

    <div id="result" style="margin-top: 20px;"></div>

    <script>
        const API_BASE = 'https://bellavka-ai-assistant-worker.ragon17886.workers.dev/api/admin';

        async function testDirect(endpoint) {
            showResult(`Testing DIRECT ${endpoint}...`);
            
            try {
                const response = await fetch(`${API_BASE}/${endpoint}`);
                const data = await response.json();
                
                showResult(`‚úÖ ${endpoint}: ${data.source}`, 'success');
                showResult(`<pre>${JSON.stringify(data, null, 2)}</pre>`);
            } catch (error) {
                showResult(`‚ùå ${endpoint}: ${error.message}`, 'error');
            }
        }

        async function testDirectQuery() {
            const query = 'SELECT name FROM sqlite_master WHERE type="table"';
            
            showResult(`Executing: ${query}`);
            
            try {
                const response = await fetch(`${API_BASE}/query`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showResult(`‚úÖ Query: ${data.source}`, 'success');
                    showResult(`<pre>${JSON.stringify(data.data, null, 2)}</pre>`);
                } else {
                    showResult(`‚ùå Query failed: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Request failed: ${error.message}`, 'error');
            }
        }

        async function checkLogs() {
            // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏ —á–µ—Ä–µ–∑ API
            try {
                const response = await fetch(`${API_BASE}/stats`);
                showResult('üìã Stats endpoint works - check Cloudflare logs for details');
            } catch (error) {
                showResult(`‚ùå Cannot check logs: ${error.message}`);
            }
        }

        function showResult(message, type = '') {
            const div = document.createElement('div');
            if (type === 'success') div.style.color = 'green';
            if (type === 'error') div.style.color = 'red';
            div.innerHTML = message;
            document.getElementById('result').appendChild(div);
        }

        testDirect('users');
    </script>
</body>
</html>